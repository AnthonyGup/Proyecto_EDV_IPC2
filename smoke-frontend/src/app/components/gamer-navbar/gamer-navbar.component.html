<header class="topbar">
  <button class="brand brand-link" (click)="goHome()">SMOKE</button>
  <nav class="nav">
    <a routerLink="/gamer" routerLinkActive="active" [routerLinkActiveOptions]="{exact: true}" class="link">Tienda</a>
    <a routerLink="/gamer/profile" routerLinkActive="active" class="link">Perfil</a>
    <a routerLink="/gamer/library" routerLinkActive="active" class="link">Biblioteca</a>
    <div class="dropdown-container" (mouseleave)="closeFamilyDropdown()" (mouseenter)="openFamilyDropdown()">
      <button class="dropdown-button" (click)="toggleFamilyDropdown()">Grupo familiar</button>
      <div class="dropdown-menu" *ngIf="showFamilyDropdown">
        <a routerLink="/gamer/family-group/list" routerLinkActive="active" (click)="unpinAndCloseFamilyDropdown()">Mis grupos</a>
        <a routerLink="/gamer/family-group/create" routerLinkActive="active" (click)="unpinAndCloseFamilyDropdown()">Crear grupo</a>
        <a routerLink="/gamer/family-group/invitations" routerLinkActive="active" (click)="unpinAndCloseFamilyDropdown()">Ver invitaciones</a>
        <a routerLink="/gamer/family-group/invite" routerLinkActive="active" (click)="unpinAndCloseFamilyDropdown()">Invitar miembros</a>
      </div>
    </div>
  </nav>
  <div class="nav-end">
    <div class="search-wrapper" [class.expanded]="showFilters">
      <input 
        type="text" 
        class="search-input" 
        placeholder="Buscar juegos..."
        [(ngModel)]="searchName"
        (click)="toggleFilters()"
      />
      
      <div class="filters-dropdown" *ngIf="showFilters">
        <label class="filter-item">
          Categoría
          <select [(ngModel)]="filterCategoryId">
            <option [ngValue]="undefined">Todas</option>
            <option *ngFor="let c of categories" [ngValue]="c.categoryId">{{ c.name }}</option>
          </select>
        </label>
        <label class="filter-item">
          Precio min
          <input type="number" [(ngModel)]="filterMinPrice" min="0" step="0.01" />
        </label>
        <label class="filter-item">
          Precio max
          <input type="number" [(ngModel)]="filterMaxPrice" min="0" step="0.01" />
        </label>
        <label class="filter-item">
          Edad máx
          <input type="number" [(ngModel)]="filterMaxAge" min="0"/>
        </label>
        <div class="filter-actions">
          <button class="btn-search" (click)="performSearch()">Buscar</button>
          <button class="btn-clear" (click)="clearSearch()">Limpiar</button>
        </div>
      </div>
    </div>
    <div class="search-wrapper simple">
      <input
        type="text"
        class="search-input"
        placeholder="Buscar compañías..."
        [(ngModel)]="companyQuery"
      />
      <div class="filter-actions compact">
        <button class="btn-search" (click)="searchCompanies()">Buscar</button>
      </div>
    </div>
    <div class="search-wrapper simple">
      <input
        type="text"
        class="search-input"
        placeholder="Buscar gamers (nickname)..."
        [(ngModel)]="gamerQuery"
        (keyup.enter)="searchGamers()"
      />
      <div class="filter-actions compact">
        <button class="btn-search" (click)="searchGamers()">Buscar</button>
      </div>
    </div>
  </div>
</header>
